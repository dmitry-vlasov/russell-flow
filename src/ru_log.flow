import ru_conf;
import ru_println;

export {
	ruServerLog(message : string, conf : RuConf) -> void;
	ruDebugLog(message : string, conf : RuConf) -> void;
}

ruServerLog(message : string, conf : RuConf) -> void {
	log_file = ruOptDef("server-log", getRussellDir() + 
		"/.log/russell_" + ruOpt("server", conf) + "_server.log", conf);
	log_dir = ruDirName(log_file);
	if (log_dir != "") {
		err = ensureDirectoryExists(log_dir);
		if (err != "") {
			ruPrintln(err, conf);
		}
	}
	if (log_file != "") {
		log_size = s2i(ruOptDef("server-log-size", "128", conf));
		ruWriteLogMessage(message, log_file, log_size);
	}
}

ruDebugLog(message : string, conf : RuConf) -> void {
	log_file = ruOptDef("debug-log", getRussellDir() + "/.log/russell_debug.log", conf);
	log_dir = ruDirName(log_file);
	if (log_dir != "") {
		err = ensureDirectoryExists(log_dir);
		if (err != "") {
			ruPrintln(err, conf);
		}
	}
	if (log_file != "") {
		log_size = s2i(ruOptDef("server-log-size", "128", conf));
		ruWriteLogMessage(message, log_file, log_size);
	}
}
