import ru/src;

export {
	RuReindexProof(
		steps : Tree<int, int>,
		refs  : Tree<RuRef, RuRef>
	);
	ruEmptyReindexProof = RuReindexProof(makeTree(), makeTree());

	ruReindexProof(proof : RuProof, reindex : RuReindexProof) -> RuProof;
}

ruReindexProof(proof : RuProof, reindex : RuReindexProof) -> RuProof {
	RuProof(proof with
		steps = map(proof.steps, 
			\step -> RuStep(step with 
				ind = lookupTreeDef(reindex.steps, step.ind, step.ind),
				refs = map(step.refs, \rf -> lookupTreeDef(reindex.refs, rf, rf))
			)
		)
	);
}
