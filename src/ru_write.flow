import ru_update;

export {
	ruWriteSource(src : RuSource, math : RuMath, conf : RuConf) -> void;
}

ruWriteSource(src : RuSource, math : RuMath, conf : RuConf) -> void {
	path = src.info.path;
	ensureDirectoryExists(ruDirName(path));
	ext = ltrim2(getFileExt(path), ".");
	if (conf.verbose > 1) {
		conf.onMessage("\t" + ext + " writing : '" + path + "'");
	}
	if (!setFileContent(src.info.path, ru2s(src, math.rules))) {
		conf.onMessage("failed to save file: '" + path + "'");
	}
	ruToCache(ruUpdateSourcePositions(src, conf), conf);
}
