import ds/tree;
import ru_src;

export {
	RuSymbs(
		symbs : [string],
		s2i   : Tree<string, int>,
	);
	RuMath(
		sources : Tree<string, RuSource>,
		consts  : Tree<string, RuConst>,
		types   : Tree<string, RuType>,
		rules   : Tree<string, RuRule>,
		assertions : Tree<string, RuAssertion>,
		onError : (string, [RuLocation]) -> void,
		symbs   : RuSymbs,
	);
	RuPlace(file : string, pos : int);
	
	ruAddSymb(s : string, rs : RuSymbs) -> RuSymbs {
		switch (lookupTree(rs.s2i, s)) {
			Some(__): rs;
			None(): {
				id = length(rs.symbs);
				RuSymbs(rs with 
					symbs = concat(rs.symbs, [s]),
					s2i = setTree(rs.s2i, s, id)
				)
			}
		}
	}
}
